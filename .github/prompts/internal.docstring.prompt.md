---
mode: edit
---
# Internal Docstring Rules and Guidelines

You are tasked with writing comprehensive docstrings for internal only functions. Follow these exact formatting rules and structure requirements.

## Required Docstring Structure

Every non-private internal function MUST include a docstring with the following sections in this exact order:

### 1. Title Section
- Start with `###` followed by a descriptive title
- Use action-oriented language (e.g., "Create a new user", "Start an Arma server", "Upload a mission")
- Keep titles concise but descriptive
- Use sentence case (capitalize only the first word and proper nouns)

### 2. Description Section
- Provide a detailed explanation of what the function does
- Include any important behavior notes (e.g., transaction rollbacks, error handling, side effects)
- Mention state changes or external effects
- Use present tense and active voice
- Be specific about the operation's impact

### 3. AI Attribution Section
- ALWAYS include the line: `*Docstring generated by AI.*`
- This must appear immediately after the title section
- Use italics formatting as shown above
- This is mandatory for all endpoint docstrings

### 4. Async/Sync Section 
- Use `**Async:**` the section header as well as body
- Format: `**Async:** Yes` or `**Async:** No` for ALL functions

### 5. Args Section
- Use `**Args:**` as the section header
- Format: `- \`parameter_name\` (\`type\`): Description of the parameter.`
- Include ALL parameters with their exact types and clear descriptions
- Use backticks around parameter names and types
- End descriptions with a period
- List parameters in the same order they appear in the function signature

### 6. Raises Section
- Use `**Raises:**` as the section header
- Format: `- \`exception_name\`: Description of the exception, and when it is raised.`
- Use backticks around parameter names and types
- End descriptions with a period
- Document all possible exceptions that can be raised by the function
- Be specific about the conditions that trigger each exception

### 7. Returns Section
- Use `**Returns:**` as the section header
- Format: `- \`ReturnType\`: Description of what is returned.`
- Be specific about the return type and structure
- Mention different return scenarios if applicable

### 8. Example Section
- Use `**Example:**` as the section header
- Include a realistic code example in a Python code block
- Show both success and error cases when relevant
- Use comments to explain expected output
- Make examples executable and realistic

## Formatting Rules

### Line length
- Keep lines under 130 characters
- All lines above 130 characters should be wrapped to the next line
- If a line is above 130 characters, it will have to be manually wrapped to the next line

### Parameter Documentation Format
```
- `parameter_name` (`type`): Description of what this parameter does.
```

### Return Documentation Format
```
- `ReturnType`: Description of what is returned and when.
```

### Exception Documentation Format
```
- `ExceptionType`: Specific condition when this exception is raised.
```

### Code Block Format
```python
response = await object.method_name('parameter')
# ExpectedReturnType
```

## Common Patterns and Examples

### State Parameters
```python
- `state` (`State`): The application state containing the database connection.
```

### User Parameters
```python
- `user` (`User`): The user performing the operation.
```

### Server Name Parameters
```python
- `server_name` (`str`): The name of the server to operate on.
```

### UUID Parameters
```python
- `iteration_uuid` (`UUID`): The UUID of the mission iteration to review.
```

### Path Parameters
```python
- `stored_pbo_path` (`Path`): The path to the stored PBO directory.
```

### API Response Returns
```python
- `JsonResponse`: A JSON response containing the result data or an error message.
- `WebResponse`: An OK response if successful, or an error response if failed.
- `Created`: A Created response indicating successful resource creation.
```

### Common Exceptions
```python
- `ServerConfigNotFound`: If the server configuration is not found.
- `ArmaServerUnresponsive`: If the server cannot be reached.
- `MissionDoesNotHaveMetadata`: If the mission lacks required metadata.
- `SessionExpired`: If the user session has expired.
```

### Exception Error Definitions
#file:bw/error/*

## Complete Template

```python
async def method_name(self, state: State, param1: str, param2: int) -> JsonResponse:
    """
    ### Brief descriptive title

    Detailed description of what the function does, including any important
    behavior notes, side effects, or state changes. Mention transaction handling
    if applicable.

    **Args:**
    - `state` (`State`): The application state containing the database connection.
    - `param1` (`str`): Description of the first parameter.
    - `param2` (`int`): Description of the second parameter.

    **Raises:**
    - `BwServerError`: An error in the function when a condition is met.

    **Example:**
    ```python
    response = ApiClass().method_name(state, 'value', 123)
    # int
    ```
    """
```

## Quality Checklist

Before submitting docstrings, verify:
- [ ] Title uses `###` and is action-oriented
- [ ] AI attribution line `*Docstring generated by AI.*` is present after the title
- [ ] Description explains what, why, and any side effects
- [ ] All parameters are documented with exact types
- [ ] Return type and content are clearly described
- [ ] All possible exceptions are documented
- [ ] Example shows realistic usage with expected outputs
- [ ] Formatting uses backticks for all code elements
- [ ] Language is consistent with existing codebase
- [ ] No spelling or grammar errors
- [ ] Follows exact structure order
- [ ] All lines are below 130 characters

## Notes
- Use triple quotes (`"""`) for all docstrings
- Maintain 4-space indentation for docstring content
- Keep consistency with existing API documentation style
- Make examples copy-pasteable when possible
- Use present tense throughout descriptions
- Be specific rather than generic in descriptions